---
layout: individual
title: 海报生成器
---

<style>
.poster-container {
    max-width: 1200px;
    margin: 20px auto;
    padding: 20px;
    display: flex;
    gap: 40px;
}

.section-title {
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #eee;
}

.preview-section {
    flex: 1;
    display: flex;
    flex-direction: column;  /* 改为纵向排列以容纳标题 */
    align-items: center;
    position: sticky;
    top: 20px;
}

.controls-section {
    flex: 1;
    max-width: 400px;
}

.controls {
    margin-bottom: 20px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    background: #f8f8f8;
    padding: 20px;
    border-radius: 10px;
}

.preview-area {
    width: 375px;
    height: 667px;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.signature {
    position: absolute;
    bottom: 20px;
    right: 20px;
    display: flex;
    flex-direction: column;  /* 改为垂直排列 */
    align-items: flex-end;   /* 右对齐 */
    gap: 5px;
    font-size: 12px;
    color: #666;
    text-align: right;
}

.qrcode {
    width: 50px;
    height: 50px;
    margin-left: 0;         /* 移除左边距 */
}

.background-options {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}

.bg-option {
    width: 50px;
    height: 50px;
    border-radius: 5px;
    cursor: pointer;
    border: 2px solid transparent;
}

.bg-option.active {
    border-color: #000;
}

#posterText {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    text-align: center;
    word-wrap: break-word;
}
</style>

<div class="poster-container">
    <div class="preview-section">
        <div class="section-title">预览</div>
        <div class="preview-area" id="preview">
            <div id="posterText"></div>
            <div id="signature" class="signature">
                <span>欢迎关注愚千一公众号</span>
                <img src="/images/gongzhonghao.jpg" id="qrcode" class="qrcode" alt="公众号二维码">
            </div>
        </div>
    </div>

    <div class="controls-section">
        <div class="section-title">设置</div>
        <div class="controls">
            <textarea id="textInput" rows="4" placeholder="输入要展示的文字..." style="width: 100%;"></textarea>
            <div class="convert-buttons" style="display: flex; gap: 10px;">
                <button onclick="convertToSimplified()" style="flex: 1; padding: 5px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 3px; cursor: pointer;">转为简体</button>
                <button onclick="convertToTraditional()" style="flex: 1; padding: 5px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 3px; cursor: pointer;">转为繁体</button>
            </div>
            
            <div>
                <label>选择背景：</label>
                <div class="background-options">
                    <div class="bg-option" style="background: linear-gradient(45deg, #FFE2E2, #FFC7C7)" data-bg="warm1"></div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #F3F0D7, #CEE5D0)" data-bg="warm2"></div>
                    <div class="bg-option" style="background: #FFF" data-bg="simple"></div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #E8DFF5, #FCF6F5)" data-bg="warm3"></div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #FFF6E9, #FFE3E1)" data-bg="warm4"></div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #E3F4F4, #D7E9F7)" data-bg="simple2"></div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #F8E8EE, #FDCEDF)" data-bg="warm5"></div>
                    <div class="bg-option" style="background: #F9F9F9" data-bg="simple3"></div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #F1F0E8, #EEE0C9)" data-bg="warm6"></div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #F5E6E8, #D2E3C8)" data-bg="simple4"></div>
                </div>
            </div>

            <div>
                <label>字体：</label>
                <select id="fontSelect">
                    <optgroup label="简体中文">
                        <option value="'Ma Shan Zheng', cursive">马善政楷书</option>
                        <option value="'Noto Serif SC', serif">思源宋体（简体）</option>
                        <option value="'ZCOOL XiaoWei', cursive">站酷小薇</option>
                        <option value="'ZCOOL KuaiLe', cursive">站酷快乐</option>
                    </optgroup>
                    <optgroup label="繁体中文">
                        <option value="'Noto Serif TC', serif">思源宋体（繁体）</option>
                        <option value="'Noto Sans TC', sans-serif">思源黑体（繁体）</option>
                    </optgroup>
                    <optgroup label="简繁通用">
                        <option value="'PMingLiU', serif">新细明体</option>
                        <option value="'DFKai-SB', serif">标楷体</option>
                    </optgroup>
                </select>
            </div>

            <div>
                <label>字体大小：</label>
                <input type="range" id="fontSize" min="12" max="96" value="24">
                <span id="fontSizeValue">24px</span>
            </div>

            <div>
                <label>字体颜色：</label>
                <input type="color" id="fontColor" value="#000000">
            </div>

            <div>
                <label>
                    <input type="checkbox" id="showSignature" checked>
                    显示签名和二维码
                </label>
            </div>
        </div>

        <button onclick="downloadPoster()" style="width: 100%; padding: 10px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">下载海报</button>
    </div>
</div>

<link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;700&family=Noto+Serif+TC:wght@400;700&family=ZCOOL+XiaoWei&family=ZCOOL+KuaiLe&family=Noto+Sans+TC&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/opencc-js@1.0.5/dist/umd/full.min.js"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<script>
// 将 updatePoster 函数移到全局作用域
function updatePoster() {
    const textInput = document.getElementById('textInput');
    const posterText = document.getElementById('posterText');
    posterText.textContent = textInput.value;
    posterText.style.fontFamily = document.getElementById('fontSelect').value;
    posterText.style.fontSize = document.getElementById('fontSize').value + 'px';
    posterText.style.color = document.getElementById('fontColor').value;
}

document.addEventListener('DOMContentLoaded', function() {
    const textInput = document.getElementById('textInput');
    const posterText = document.getElementById('posterText');
    const preview = document.getElementById('preview');
    const fontSelect = document.getElementById('fontSelect');
    const fontSize = document.getElementById('fontSize');
    const fontSizeValue = document.getElementById('fontSizeValue');
    const fontColor = document.getElementById('fontColor');
    const bgOptions = document.querySelectorAll('.bg-option');

    // 从本地存储加载上次的文本内容
    const savedText = localStorage.getItem('posterText');
    if (savedText) {
        textInput.value = savedText;
        posterText.textContent = savedText;
    }

    // 文本输入监听
    textInput.addEventListener('input', function() {
        updatePoster();
        // 保存到本地存储
        localStorage.setItem('posterText', textInput.value);
    });
    
    // 字体选择监听
    fontSelect.addEventListener('change', updatePoster);
    
    // 字体大小监听
    fontSize.addEventListener('input', function() {
        fontSizeValue.textContent = this.value + 'px';
        updatePoster();
        localStorage.setItem('posterFontSize', this.value);
    });
    
    // 字体颜色监听
    fontColor.addEventListener('input', function() {
        updatePoster();
        localStorage.setItem('posterFontColor', this.value);
    });
    
    // 背景选择监听
    bgOptions.forEach(option => {
        option.addEventListener('click', function() {
            bgOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            preview.style.background = this.style.background;
            localStorage.setItem('posterBackground', this.style.background);
        });
    });

    const showSignature = document.getElementById('showSignature');
    const signature = document.getElementById('signature');
    const qrcode = document.getElementById('qrcode');

    // 初始化签名和二维码显示状态
    updateSignatureVisibility();

    // 签名显示控制监听
    showSignature.addEventListener('change', updateSignatureVisibility);

    function updateSignatureVisibility() {
        const isVisible = showSignature.checked ? 'flex' : 'none';  // 改为 'flex'
        signature.style.display = isVisible;
        // 移除对 qrcode 的单独控制
    }
    // 从本地存储加载所有设置
    const savedFontSize = localStorage.getItem('posterFontSize');
    const savedFontColor = localStorage.getItem('posterFontColor');
    const savedBackground = localStorage.getItem('posterBackground');
    const savedFont = localStorage.getItem('posterFont');
    const savedSignature = localStorage.getItem('showSignature');

    // 恢复文本
    if (savedText) {
        textInput.value = savedText;
        posterText.textContent = savedText;
    }

    // 恢复字体大小
    if (savedFontSize) {
        fontSize.value = savedFontSize;
        fontSizeValue.textContent = savedFontSize + 'px';
        posterText.style.fontSize = savedFontSize + 'px';
    }

    // 恢复字体颜色
    if (savedFontColor) {
        fontColor.value = savedFontColor;
        posterText.style.color = savedFontColor;
    }

    // 恢复背景
    if (savedBackground) {
        bgOptions.forEach(opt => {
            if (opt.style.background === savedBackground) {
                opt.classList.add('active');
                preview.style.background = savedBackground;
            }
        });
    }

    // 恢复字体选择
    if (savedFont) {
        fontSelect.value = savedFont;
        posterText.style.fontFamily = savedFont;
    }

    // 恢复签名显示状态
    if (savedSignature !== null) {
        showSignature.checked = savedSignature === 'true';
        updateSignatureVisibility();
    }

    // 字体选择监听
    fontSelect.addEventListener('change', function() {
        updatePoster();
        localStorage.setItem('posterFont', this.value);
    });

    // 签名显示控制监听
    showSignature.addEventListener('change', function() {
        updateSignatureVisibility();
        localStorage.setItem('showSignature', this.checked);
    });
});

function downloadPoster() {
    html2canvas(document.getElementById('preview')).then(canvas => {
        const link = document.createElement('a');
        link.download = '海报.png';
        link.href = canvas.toDataURL();
        link.click();
    });
}

// 添加简繁转换功能
// Remove these lines
// let converter;
// OpenCC.load().then((_converter) => {
//     converter = _converter;
// });

// Initialize converters
const converterToTraditional = OpenCC.Converter({ from: 'cn', to: 'tw' });
const converterToSimplified = OpenCC.Converter({ from: 'tw', to: 'cn' });

function convertToSimplified() {
    const text = textInput.value;
    textInput.value = converterToSimplified(text);
    updatePoster();
    localStorage.setItem('posterText', textInput.value);
}

function convertToTraditional() {
    const text = textInput.value;
    textInput.value = converterToTraditional(text);
    updatePoster();
    localStorage.setItem('posterText', textInput.value);
}
</script>

